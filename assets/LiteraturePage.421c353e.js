import{k as _,Q as x}from"./QBtn.555cd44b.js";import{Q as y,e as b}from"./export-file.b73941a2.js";import{r as v,F as k,O as F,Y as u,J as d,I as f,Q as w}from"./index.243ddde5.js";import"./format.ee0e2520.js";const Q=u("h2",null,"Literature Page",-1),U={class:"q-pa-md q-gutter-sm"},V=u("span",{class:"q-ml-md"}," Upload ",-1),q={__name:"LiteraturePage",setup(B){const n=v(null),m=()=>{console.log(n.value)},a=v({loading:!1,percentage:0}),h=()=>{a.value.loading=!0,a.value.percentage=0;let r={};var t=new FileReader;t.readAsText(n.value,"UTF-8"),t.onload=async c=>{console.log(c.target.result);let i=c.target.result.split(`
@`),o={};for(let e=1;e<i.length;e++){const l=i[e].split("{")[0];o[l]||(o[l]=[]),o[l].push(i[e])}o.all=i;const p=Object.keys(o);for(let e=0;e<p.length;e++){const l=p[e],g=await(await fetch("http://127.0.0.1:8787/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:o[l].join(`
@`),category:l})})).text();console.log(l,"Success:",g),a.value.percentage=e/p.length*100,r[l]=g}a.value.percentage=100,a.value.loading=!1;for(const e in r)b(`publish_${e}.mods`,r[e])},t.onerror=function(c){alert("error reading file")};const s=setInterval(()=>{a.value.percentage+=10,a.value.percentage>=100&&(clearInterval(s),a.value.loading=!1,a.value.percentage=0)},1e3)};return(r,t)=>(k(),F(w,null,[Q,u("div",U,[d(y,{modelValue:n.value,"onUpdate:modelValue":[t[0]||(t[0]=s=>n.value=s),m],label:"Upload Citavi Export",filled:"",append:"",style:{"max-width":"300px"},clearable:""},{prepend:f(()=>[d(x,{name:"attach_file"})]),_:1},8,["modelValue"]),d(_,{disable:!n.value,loading:a.value.loading,percentage:a.value.percentage,"dark-percentage":"",unelevated:"",color:"blue","text-color":"white",onClick:t[1]||(t[1]=s=>h()),icon:"cloud_upload"},{default:f(()=>[V]),_:1},8,["disable","loading","percentage"])])],64))}};export{q as default};
