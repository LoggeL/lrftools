import{k as _,Q as x}from"./QBtn.22ad420d.js";import{Q as y,e as b}from"./export-file.98fbc9f6.js";import{r as v,F as k,O as w,Y as u,J as d,I as f,Q as F}from"./index.eac6856c.js";import"./format.bb06997b.js";const Q=u("h2",null,"Literature Page",-1),U={class:"q-pa-md q-gutter-sm"},V=u("span",{class:"q-ml-md"}," Upload ",-1),q={__name:"LiteraturePage",setup(B){const n=v(null),m=()=>{console.log(n.value)},t=v({loading:!1,percentage:0}),h=()=>{t.value.loading=!0,t.value.percentage=0;let r={};var a=new FileReader;a.readAsText(n.value,"UTF-8"),a.onload=async c=>{console.log(c.target.result);let i=c.target.result.split(`
@`),o={};for(let e=1;e<i.length;e++){const l=i[e].split("{")[0];o[l]||(o[l]=[]),o[l].push(i[e])}o.all=i;const p=Object.keys(o);for(let e=0;e<p.length;e++){const l=p[e],g=await(await fetch("https://literature.logge.workers.dev/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:o[l].join(`
@`),category:l})})).text();console.log(l,"Success:",g),t.value.percentage=e/p.length*100,r[l]=g}t.value.percentage=100,t.value.loading=!1;for(const e in r)b(`publish_${e}.mods`,r[e])},a.onerror=function(c){alert("error reading file")};const s=setInterval(()=>{t.value.percentage+=10,t.value.percentage>=100&&(clearInterval(s),t.value.loading=!1,t.value.percentage=0)},1e3)};return(r,a)=>(k(),w(F,null,[Q,u("div",U,[d(y,{modelValue:n.value,"onUpdate:modelValue":[a[0]||(a[0]=s=>n.value=s),m],label:"Upload Citavi Export",filled:"",append:"",style:{"max-width":"300px"},clearable:""},{prepend:f(()=>[d(x,{name:"attach_file"})]),_:1},8,["modelValue"]),d(_,{disable:!n.value,loading:t.value.loading,percentage:t.value.percentage,"dark-percentage":"",unelevated:"",color:"blue","text-color":"white",onClick:a[1]||(a[1]=s=>h()),icon:"cloud_upload"},{default:f(()=>[V]),_:1},8,["disable","loading","percentage"])])],64))}};export{q as default};
